!function(a){var b;return b=function(a){var b,c,d,e,f;for(b=d=e=a.length-1;1>=e?1>=d:d>=1;b=1>=e?++d:--d)c=Math.floor(Math.random()*(b+1)),f=[a[c],a[b]],a[b]=f[0],a[c]=f[1];return a},a.chaperone=function(a,b,c){var d,e,f;return null==a&&(a=10),null==b&&(b=10),null==c&&(c=1),e=function(a){return Math.floor(Math.random()*a)},d=0,function(){f=[];for(var b=0;a>=0?a>b:b>a;a>=0?b++:b--)f.push(b);return f}.apply(this).map(function(){var a,f,g;for(f=g=0;b>=0?b>g:g>b;f=b>=0?++g:--g)if(a=e(b),!(a+c>=d&&d>a-c))return d=a,a;return e(b)})},a.socialist=function(a,c){var d,e,f;return null==a&&(a=10),null==c&&(c=10),e=function(a){var c;return b(function(){c=[];for(var b=0;a>=0?a>b:b>a;a>=0?b++:b--)c.push(b);return c}.apply(this))},d=[],function(){f=[];for(var b=0,d=a/c;d>=0?d>b:b>d;d>=0?b++:b--)f.push(b);return f}.apply(this).map(function(){var b,f,g;for(f=g=0;c>=0?c>g:g>c;f=c>=0?++g:--g)if(b=e(c).slice(0,c),d=d.concat(b),d.length>=a)return d}),d}}(jQuery),$(function(){var a,b,c,d,e,f,g;return a=function(){},this.style("left",function(a){return a.x+"px"}).style("top",function(a){return a.y+"px"}).style("width",function(a){return a.dx-1+"px"}).style("height",function(a){return a.dy-1+"px"}),g=960,d=500,b=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],f=d3.layout.treemap().size([g,d]).sticky(!0).value(function(a){return a.size}),c=d3.select("#chart").append("div").style("position","relative").style("width",g+"px").style("height",d+"px"),e={name:"flare",size:50,children:[{name:"analytics",children:[{name:"cluster",children:[{name:"aa",size:138},{name:"ff",size:112},{name:"dd",size:143}]},{name:"graph",children:[{name:"ccc",size:134},{name:"wwwww",size:131}]}]},{name:"asdf",size:134}]},c.data([e]).selectAll("div").data(f.nodes).enter().append("div").attr("class","cell").style("background",function(a,c){return a.children?void 0:b[c]}).data(f.value(function(){return 1})).call(a).text(function(a){return a.children?null:a.name}),c.selectAll("div").data(f.value(function(a){return a.size})).transition().duration(2500).call(a)}),function(a){!function(){function a(a){return a?d.escapeRegExp(a):"\\s"}var b=this,c=String.prototype.trim,d={startsWith:function(a,b){return a.length>=b.length&&a.substring(0,b.length)===b},endsWith:function(a,b){return a.length>=b.length&&a.substring(a.length-b.length)===b},trim:function(b,d){return!d&&c?c.call(b):(d=a(d),b.replace(new RegExp("^["+d+"]+|["+d+"]+$","g"),""))},ltrim:function(b,c){return c=a(c),b.replace(new RegExp("^["+c+"]+","g"),"")},rtrim:function(b,c){return c=a(c),b.replace(new RegExp("["+c+"]+$","g"),"")}};"undefined"==typeof window&&"undefined"!=typeof module?module.exports=d:"undefined"!=typeof b._?b._.mixin(d):b._=d}(),function(){var a,b,c,d,e,f,g,h,i,j,k=function(a){return a.reduce(function(a,b){return a.concat(b)},[])},l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=this,d={escapeHTML:function(a){return String(a||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},perserveWhitespace:function(a){var b,c,d,e;if(d=/<[a-zA-Z]+>[^<]*<\/[a-zA-Z]+>/g,c="",b=0,e=d.exec(a),e){for(;e;)c+=a.substring(b,e.index),c+=e[0].replace(/\n/g,"&#x000A;"),b=e.index+e[0].length,e=d.exec(a);c+=a.substring(b)}else c=a;return c},templateError:function(a,b,c,d){var e,f;for(f=d+" at line "+a+" and character "+b+":\n"+c+"\n",e=0;b-1>e;)f+="-",e++;return f+="^"},generateElementAttributes:function(a,b,c,d,e,f,g,h,i){var j,m,n,o,p,q,r,s,t,u;if(m={},m=this.combineAttributes(m,"id",b),c.length>0&&c[0].length>0&&(m=this.combineAttributes(m,"class",c)),null!=e)for(j in e)l.call(e,j)&&(u=e[j],m=this.combineAttributes(m,j,u));if(null!=d)try{s=d.call(a,a),null!=s&&(t=null,null!=s.id?t=s.id:s.get&&(t=s.get("id")),m=this.combineAttributes(m,"id",t),n=null,s["class"]?n=s["class"]:s.get&&(n=s.get("class")),m=this.combineAttributes(m,"class",n))}catch(v){throw o=v,haml.HamlRuntime.templateError(g,h,i,"Error evaluating object reference - "+o)}if(null!=f)try{if(q=f.call(a,a),null!=q){q=this._flattenHash(null,q);for(j in q)l.call(q,j)&&(u=q[j],m=this.combineAttributes(m,j,u))}}catch(v){throw p=v,haml.HamlRuntime.templateError(g,h,i,"Error evaluating attribute hash - "+p)}if(r="",m)for(j in m)l.call(m,j)&&haml.hasValue(m[j])&&(r+=("id"===j||"for"===j)&&m[j]instanceof Array?" "+j+'="'+k(m[j]).join("-")+'"':"class"===j&&m[j]instanceof Array?" "+j+'="'+k(m[j]).join(" ")+'"':" "+j+'="'+haml.attrValue(j,m[j])+'"');return r},indentText:function(a){var b,c;for(c="",b=0;a>b;)c+="  ",b++;return c},combineAttributes:function(a,b,c){var d;return haml.hasValue(c)&&("id"===b&&c.toString().length>0?a&&a.id instanceof Array?a.id.unshift(c):a&&a.id?a.id=[a.id,c]:a?a.id=c:a={id:c}:"for"===b&&c.toString().length>0?a&&a["for"]instanceof Array?a["for"].unshift(c):a&&a["for"]?a["for"]=[a["for"],c]:a?a["for"]=c:a={"for":c}:"class"===b?(d=[],c instanceof Array?d=d.concat(c):d.push(c),a&&a["class"]?a["class"]=a["class"].concat(d):a?a["class"]=d:a={"class":d}):"id"!==b&&(a||(a={}),a[b]=c)),a},_flattenHash:function(a,b){var c,d,e,f,g,h,i,j;if(i={},this._isHash(b)){for(c in b)if(l.call(b,c))if(j=b[c],f=[],null!=a&&f.push(a),f.push(c),e=f.join("-"),d=this._flattenHash(e,j),this._isHash(d))for(g in d)l.call(d,g)&&(h=d[g],i[g]=h);else i[e]=d}else null!=a?i[a]=b:i=b;return i},_isHash:function(a){return null!=a&&"object"==typeof a&&!(a instanceof Array||a instanceof Date)}},g=function(){function a(a){var b,c,d,e=this;if(this.buffer=null,this.bufferIndex=null,this.prevToken=null,this.token=null,null!=a.templateId){if(d=document.getElementById(a.templateId),!d)throw"Did not find a template with ID '"+a.templateId+"'";this.buffer=d.text,this.bufferIndex=0}else null!=a.template?(this.buffer=a.template,this.bufferIndex=0):null!=a.templateUrl&&(b=function(b,c,d){throw"Failed to fetch haml template at URL "+a.templateUrl+": "+c+" "+d},c=function(a){return e.buffer=a,e.bufferIndex=0},jQuery.ajax({url:a.templateUrl,success:c,error:b,dataType:"text",async:!1,beforeSend:function(a){return a.withCredentials=!0}}))}return a.prototype.currentLineMatcher=/[^\n]*/g,a.prototype.tokenMatchers={whitespace:/[ \t]+/g,element:/%[a-zA-Z][a-zA-Z0-9]*/g,idSelector:/#[a-zA-Z_\-][a-zA-Z0-9_\-]*/g,classSelector:/\.[a-zA-Z0-9_\-]+/g,identifier:/[a-zA-Z][a-zA-Z0-9\-]*/g,quotedString:/[\'][^\'\n]*[\']/g,quotedString2:/[\"][^\"\n]*[\"]/g,comment:/\-#/g,escapeHtml:/\&=/g,unescapeHtml:/\!=/g,objectReference:/\[[a-zA-Z_@][a-zA-Z0-9_]*\]/g,doctype:/!!!/g,continueLine:/\|\s*\n/g,filter:/:\w+/g},a.prototype.matchToken=function(a){var b;return a.lastIndex=this.bufferIndex,b=a.exec(this.buffer),(null!=b?b.index:void 0)===this.bufferIndex?b[0]:void 0},a.prototype.matchMultiCharToken=function(a,b,c){var d,e;return!this.token&&(d=this.matchToken(a))?(this.token=b,this.token.tokenString=null!=(e="function"==typeof c?c(d):void 0)?e:d,this.token.matched=d,this.advanceCharsInBuffer(d.length)):void 0},a.prototype.matchSingleCharToken=function(a,b){return this.token||this.buffer.charAt(this.bufferIndex)!==a?void 0:(this.token=b,this.token.tokenString=a,this.token.matched=a,this.advanceCharsInBuffer(1))},a.prototype.getNextToken=function(){var a,b,c,d,e,f,g;if(isNaN(this.bufferIndex))throw haml.HamlRuntime.templateError(this.lineNumber,this.characterNumber,this.currentLine,"An internal parser error has occurred in the HAML parser");if(this.prevToken=this.token,this.token=null,null===this.buffer||this.buffer.length===this.bufferIndex)this.token={eof:!0,token:"EOF"};else{if(this.initLine(),this.token||(b=this.buffer.charCodeAt(this.bufferIndex),c=this.buffer.charCodeAt(this.bufferIndex+1),(10===b||13===b&&10===c)&&(this.token={eol:!0,token:"EOL"},13===b&&10===c?(this.advanceCharsInBuffer(2),this.token.matched=String.fromCharCode(b)+String.fromCharCode(c)):(this.advanceCharsInBuffer(1),this.token.matched=String.fromCharCode(b)),this.characterNumber=0,this.currentLine=this.getCurrentLine())),this.matchMultiCharToken(this.tokenMatchers.whitespace,{ws:!0,token:"WS"}),this.matchMultiCharToken(this.tokenMatchers.continueLine,{continueLine:!0,token:"CONTINUELINE"}),this.matchMultiCharToken(this.tokenMatchers.element,{element:!0,token:"ELEMENT"},function(a){return a.substring(1)}),this.matchMultiCharToken(this.tokenMatchers.idSelector,{idSelector:!0,token:"ID"},function(a){return a.substring(1)}),this.matchMultiCharToken(this.tokenMatchers.classSelector,{classSelector:!0,token:"CLASS"},function(a){return a.substring(1)}),this.matchMultiCharToken(this.tokenMatchers.identifier,{identifier:!0,token:"IDENTIFIER"}),this.matchMultiCharToken(this.tokenMatchers.doctype,{doctype:!0,token:"DOCTYPE"}),this.matchMultiCharToken(this.tokenMatchers.filter,{filter:!0,token:"FILTER"},function(a){return a.substring(1)}),this.token||(g=this.matchToken(this.tokenMatchers.quotedString),g||(g=this.matchToken(this.tokenMatchers.quotedString2)),g&&(this.token={string:!0,token:"STRING",tokenString:g.substring(1,g.length-1),matched:g},this.advanceCharsInBuffer(g.length))),this.matchMultiCharToken(this.tokenMatchers.comment,{comment:!0,token:"COMMENT"}),this.matchMultiCharToken(this.tokenMatchers.escapeHtml,{escapeHtml:!0,token:"ESCAPEHTML"}),this.matchMultiCharToken(this.tokenMatchers.unescapeHtml,{unescapeHtml:!0,token:"UNESCAPEHTML"}),this.matchMultiCharToken(this.tokenMatchers.objectReference,{objectReference:!0,token:"OBJECTREFERENCE"},function(a){return a.substring(1,a.length-1)}),!this.token&&this.buffer&&"{"===this.buffer.charAt(this.bufferIndex)){for(e=this.bufferIndex+1,d=this.characterNumber,f=this.lineNumber,a=1;e<this.buffer.length&&(a>1||"}"!==this.buffer.charAt(e));)"{"===this.buffer.charAt(e)?a++:"}"===this.buffer.charAt(e)&&a--,e++;if(e===this.buffer.length)throw this.characterNumber=d+1,this.lineNumber=f,this.parseError('Error parsing attribute hash - Did not find a terminating "}"');this.token={attributeHash:!0,token:"ATTRHASH",tokenString:this.buffer.substring(this.bufferIndex,e+1),matched:this.buffer.substring(this.bufferIndex,e+1)},this.advanceCharsInBuffer(e-this.bufferIndex+1)}this.matchSingleCharToken("(",{openBracket:!0,token:"OPENBRACKET"}),this.matchSingleCharToken(")",{closeBracket:!0,token:"CLOSEBRACKET"}),this.matchSingleCharToken("=",{equal:!0,token:"EQUAL"}),this.matchSingleCharToken("/",{slash:!0,token:"SLASH"}),this.matchSingleCharToken("!",{exclamation:!0,token:"EXCLAMATION"}),this.matchSingleCharToken("-",{minus:!0,token:"MINUS"}),this.matchSingleCharToken("&",{amp:!0,token:"AMP"}),this.matchSingleCharToken("<",{lt:!0,token:"LT"}),this.matchSingleCharToken(">",{gt:!0,token:"GT"}),this.matchSingleCharToken("~",{tilde:!0,token:"TILDE"}),null===this.token&&(this.token={unknown:!0,token:"UNKNOWN"})}return this.token},a.prototype.lookAhead=function(a){var b,c,d,e,f,g,h,i;if(i=null,a>0){for(e=this.token,h=this.prevToken,d=this.currentLine,g=this.lineNumber,c=this.characterNumber,b=this.bufferIndex,f=0;f++<a;)i=this.getNextToken();this.token=e,this.prevToken=h,this.currentLine=d,this.lineNumber=g,this.characterNumber=c,this.bufferIndex=b}return i},a.prototype.initLine=function(){return this.currentLine||""===this.currentLine?void 0:(this.currentLine=this.getCurrentLine(),this.lineNumber=1,this.characterNumber=0)},a.prototype.getCurrentLine=function(a){var b;return this.currentLineMatcher.lastIndex=this.bufferIndex+(null!=a?a:0),b=this.currentLineMatcher.exec(this.buffer),b?b[0]:""},a.prototype.parseError=function(a){return haml.HamlRuntime.templateError(this.lineNumber,this.characterNumber,this.currentLine,a)},a.prototype.skipToEOLorEOF=function(){var a,b,c;return c="",!this.token.eof&&!this.token.eol&&(this.token.unknown||(c+=this.token.matched),this.currentLineMatcher.lastIndex=this.bufferIndex,b=this.currentLineMatcher.exec(this.buffer),b&&b.index===this.bufferIndex&&(a=(_.str||_).rtrim(b[0]),(_.str||_).endsWith(a,"|")?(c+=a.substring(0,a.length-1),this.advanceCharsInBuffer(a.length-1),this.getNextToken(),c+=this.parseMultiLine()):(c+=b[0],this.advanceCharsInBuffer(b[0].length),this.getNextToken()))),c},a.prototype.parseMultiLine=function(){var a,b,c;for(c="";this.token.continueLine;)this.currentLineMatcher.lastIndex=this.bufferIndex,b=this.currentLineMatcher.exec(this.buffer),b&&b.index===this.bufferIndex&&(a=(_.str||_).rtrim(b[0]),(_.str||_).endsWith(a,"|")&&(c+=a.substring(0,a.length-1),this.advanceCharsInBuffer(a.length-1)),this.getNextToken());return c},a.prototype.advanceCharsInBuffer=function(a){var b,c,d;for(d=0;a>d;)b=this.buffer.charCodeAt(this.bufferIndex+d),c=this.buffer.charCodeAt(this.bufferIndex+d+1),13===b&&10===c?(this.lineNumber++,this.characterNumber=0,this.currentLine=this.getCurrentLine(d),d++):10===b?(this.lineNumber++,this.characterNumber=0,this.currentLine=this.getCurrentLine(d)):this.characterNumber++,d++;return this.bufferIndex+=a},a.prototype.currentParsePoint=function(){return{lineNumber:this.lineNumber,characterNumber:this.characterNumber,currentLine:this.currentLine}},a.prototype.pushBackToken=function(){return this.token.unknown||this.token.eof?void 0:(this.bufferIndex-=this.token.matched.length,this.token=this.prevToken)},a.prototype.isEolOrEof=function(){return this.token.eol||this.token.eof},a}(),a=function(){function a(a){this.generator=a,this.buffer="",this.outputBuffer=""}return a.prototype.append=function(a){return null!=this.generator&&0===this.buffer.length&&this.generator.mark(),(null!=a?a.length:void 0)>0?this.buffer+=a:void 0},a.prototype.appendToOutputBuffer=function(a){return(null!=a?a.length:void 0)>0?(this.flush(),this.outputBuffer+=a):void 0},a.prototype.flush=function(){var a;return(null!=(a=this.buffer)?a.length:void 0)>0&&(this.outputBuffer+=this.generator.generateFlush(this.buffer)),this.buffer=""},a.prototype.output=function(){return this.outputBuffer},a.prototype.trimWhitespace=function(){var a,b;if(this.buffer.length>0){for(b=this.buffer.length-1;b>0;)if(a=this.buffer.charAt(b)," "===a||"  "===a||"\n"===a)b--;else{if(!(b>1)||"n"!==a&&"t"!==a||"\\"!==this.buffer.charAt(b-1))break;b-=2}if(b>0&&b<this.buffer.length-1)return this.buffer=this.buffer.substring(0,b+1);if(0===b)return this.buffer=""}},a}(),b=function(){function a(){}return a.prototype.embeddedCodeBlockMatcher=/#{([^}]*)}/g,a}(),e=function(a){function b(){this.outputBuffer=new haml.Buffer(this)}return m(b,a),b.prototype.appendEmbeddedCode=function(a,b,c,d,e){return this.outputBuffer.flush(),this.outputBuffer.appendToOutputBuffer(a+"try {\n"),this.outputBuffer.appendToOutputBuffer(a+'    var value = eval("'+(_.str||_).trim(b).replace(/"/g,'\\"').replace(/\\n/g,"\\\\n")+'");\n'),this.outputBuffer.appendToOutputBuffer(a+'    value = value === null ? "" : value;'),c?this.outputBuffer.appendToOutputBuffer(a+"    html.push(haml.HamlRuntime.escapeHTML(String(value)));\n"):d?this.outputBuffer.appendToOutputBuffer(a+"    html.push(haml.HamlRuntime.perserveWhitespace(String(value)));\n"):this.outputBuffer.appendToOutputBuffer(a+"    html.push(String(value));\n"),this.outputBuffer.appendToOutputBuffer(a+"} catch (e) {\n"),this.outputBuffer.appendToOutputBuffer(a+"  throw new Error(haml.HamlRuntime.templateError("+e.lineNumber+", "+e.characterNumber+', "'+this.escapeCode(e.currentLine)+'",\n'),this.outputBuffer.appendToOutputBuffer(a+'    "Error evaluating expression - " + e));\n'),this.outputBuffer.appendToOutputBuffer(a+"}\n")},b.prototype.initOutput=function(){return this.outputBuffer.appendToOutputBuffer("  var html = [];\n  var hashFunction = null, hashObject = null, objRef = null, objRefFn = null;\n  with (context || {}) {\n")},b.prototype.closeAndReturnOutput=function(){return this.outputBuffer.flush(),this.outputBuffer.output()+'  }\n  return html.join("");\n'},b.prototype.appendCodeLine=function(a,b){return this.outputBuffer.flush(),this.outputBuffer.appendToOutputBuffer(d.indentText(this.indent)),this.outputBuffer.appendToOutputBuffer(a),this.outputBuffer.appendToOutputBuffer(b)},b.prototype.lineMatchesStartFunctionBlock=function(a){return a.match(/function\s*\((,?\s*\w+)*\)\s*\{\s*$/)},b.prototype.lineMatchesStartBlock=function(a){return a.match(/\{\s*$/)},b.prototype.closeOffCodeBlock=function(a){return a.token.minus&&a.matchToken(/\s*\}/g)?void 0:(this.outputBuffer.flush(),this.outputBuffer.appendToOutputBuffer(d.indentText(this.indent)+"}\n"))},b.prototype.closeOffFunctionBlock=function(a){return a.token.minus&&a.matchToken(/\s*\}/g)?void 0:(this.outputBuffer.flush(),this.outputBuffer.appendToOutputBuffer(d.indentText(this.indent)+"});\n"))},b.prototype.generateCodeForDynamicAttributes=function(a,b,c,d,e,f){return this.outputBuffer.flush(),d.length>0&&(d=this.replaceReservedWordsInHash(d),this.outputBuffer.appendToOutputBuffer('    hashFunction = function () { return eval("hashObject = '+d.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"); };\n')),e.length>0&&this.outputBuffer.appendToOutputBuffer('    objRefFn = function () { return eval("objRef = '+e.replace(/"/g,'\\"')+'"); };\n'),this.outputBuffer.appendToOutputBuffer('    html.push(haml.HamlRuntime.generateElementAttributes(context, "'+a+'", ["'+b.join('","')+'"], objRefFn, '+JSON.stringify(c)+", hashFunction, "+f.lineNumber+", "+f.characterNumber+', "'+this.escapeCode(f.currentLine)+'"));\n')},b.prototype.replaceReservedWordsInHash=function(a){var b,c,d,e,f;for(c=a,f=["class","for"],d=0,e=f.length;e>d;d++)b=f[d],c=c.replace(b+":",'"'+b+'":');return c},b.prototype.escapeCode=function(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")},b.prototype.generateJsFunction=function(a){var b;try{return new Function("context",a)}catch(c){throw b=c,"Incorrect embedded code has resulted in an invalid Haml function - "+b+"\nGenerated Function:\n"+a}},b.prototype.generateFlush=function(a){return'    html.push("'+this.escapeCode(a)+'");\n'},b.prototype.setIndent=function(a){return this.indent=a},b.prototype.mark=function(){},b.prototype.appendTextContents=function(a,b,c,d){return null==d&&(d={}),b&&a.match(/#{[^}]*}/)?this.interpolateString(a,c,d):this.outputBuffer.append(this.processText(a,d))},b.prototype.interpolateString=function(a,b,c){var e,f,g,h;for(e=0,h=this.embeddedCodeBlockMatcher.exec(a);h;)h.index>0&&(f=a.charAt(h.index-1)),h.index>1&&(g=a.charAt(h.index-2)),"\\"===f&&"\\"!==g?(0!==h.index&&this.outputBuffer.append(this.processText(a.substring(e,h.index-1),c)),this.outputBuffer.append(this.processText(h[0]),c)):(this.outputBuffer.append(this.processText(a.substring(e,h.index)),c),this.appendEmbeddedCode(d.indentText(this.indent+1),h[1],c.escapeHTML,c.perserveWhitespace,b)),e=this.embeddedCodeBlockMatcher.lastIndex,h=this.embeddedCodeBlockMatcher.exec(a);return e<a.length?this.outputBuffer.append(this.processText(a.substring(e),c)):void 0},b.prototype.processText=function(a,b){return(null!=b?b.escapeHTML:void 0)?haml.HamlRuntime.escapeHTML(a):(null!=b?b.perserveWhitespace:void 0)?haml.HamlRuntime.perserveWhitespace(a):a},b}(b),f=function(a){function b(){return j=b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.appendEmbeddedCode=function(a,b,c,d){return this.outputBuffer.flush(),this.outputBuffer.appendToOutputBuffer(a+"    value = "+(_.str||_).trim(b)+";\n"),this.outputBuffer.appendToOutputBuffer(a+'    value = value === null ? "" : value;'),c?this.outputBuffer.appendToOutputBuffer(a+"    html.push(haml.HamlRuntime.escapeHTML(String(value)));\n"):d?this.outputBuffer.appendToOutputBuffer(a+"    html.push(haml.HamlRuntime.perserveWhitespace(String(value)));\n"):this.outputBuffer.appendToOutputBuffer(a+"    html.push(String(value));\n")},b.prototype.generateCodeForDynamicAttributes=function(a,b,c,d,e,f){return this.outputBuffer.flush(),d.length>0&&(d=this.replaceReservedWordsInHash(d),this.outputBuffer.appendToOutputBuffer("    hashFunction = function () { return "+d+"; };\n")),e.length>0&&this.outputBuffer.appendToOutputBuffer("    objRefFn = function () { return "+e+"; };\n"),this.outputBuffer.appendToOutputBuffer('    html.push(haml.HamlRuntime.generateElementAttributes(context, "'+a+'", ["'+b.join('","')+'"], objRefFn, '+JSON.stringify(c)+", hashFunction, "+f.lineNumber+", "+f.characterNumber+', "'+this.escapeCode(f.currentLine)+'"));\n')},b.prototype.initOutput=function(){return this.outputBuffer.appendToOutputBuffer("  var html = [];\n  var hashFunction = null, hashObject = null, objRef = null, objRefFn = null, value= null;\n  with (context || {}) {\n")},b}(e),c=function(a){function b(){this.outputBuffer=new haml.Buffer(this)}return m(b,a),b.prototype.appendEmbeddedCode=function(a,b,c,d,e){var f;return this.outputBuffer.flush(),f=this.calcCodeIndent(),this.outputBuffer.appendToOutputBuffer(f+"try\n"),this.outputBuffer.appendToOutputBuffer(f+"  exp = CoffeeScript.compile('"+b.replace(/'/g,"\\'").replace(/\\n/g,"\\\\n")+"', bare: true)\n"),this.outputBuffer.appendToOutputBuffer(f+"  value = eval(exp)\n"),this.outputBuffer.appendToOutputBuffer(f+"  value ?= ''\n"),c?this.outputBuffer.appendToOutputBuffer(f+"  html.push(haml.HamlRuntime.escapeHTML(String(value)))\n"):d?this.outputBuffer.appendToOutputBuffer(f+"  html.push(haml.HamlRuntime.perserveWhitespace(String(value)))\n"):this.outputBuffer.appendToOutputBuffer(f+"  html.push(String(value))\n"),this.outputBuffer.appendToOutputBuffer(f+"catch e \n"),this.outputBuffer.appendToOutputBuffer(f+"  throw new Error(haml.HamlRuntime.templateError("+e.lineNumber+", "+e.characterNumber+", '"+this.escapeCode(e.currentLine)+"',\n"),this.outputBuffer.appendToOutputBuffer(f+"    'Error evaluating expression - ' + e))\n")},b.prototype.initOutput=function(){return this.outputBuffer.appendToOutputBuffer("html = []\n")},b.prototype.closeAndReturnOutput=function(){return this.outputBuffer.flush(),this.outputBuffer.output()+'return html.join("")\n'},b.prototype.appendCodeLine=function(a,b){return this.outputBuffer.flush(),this.outputBuffer.appendToOutputBuffer(this.calcCodeIndent()),this.outputBuffer.appendToOutputBuffer((_.str||_).trim(a)),this.outputBuffer.appendToOutputBuffer(b),this.prevCodeIndent=this.indent},b.prototype.lineMatchesStartFunctionBlock=function(a){return a.match(/\) [\-=]>\s*$/)},b.prototype.lineMatchesStartBlock=function(){return!0},b.prototype.closeOffCodeBlock=function(){return this.outputBuffer.flush()},b.prototype.closeOffFunctionBlock=function(){return this.outputBuffer.flush()},b.prototype.generateCodeForDynamicAttributes=function(a,b,c,d,e,f){var g;return this.outputBuffer.flush(),g=this.calcCodeIndent(),d.length>0&&(d=this.replaceReservedWordsInHash(d),this.outputBuffer.appendToOutputBuffer(g+"hashFunction = () -> s = CoffeeScript.compile('"+d.replace(/'/g,"\\'").replace(/\n/g,"\\n")+"', bare: true); eval 'hashObject = ' + s\n")),e.length>0&&this.outputBuffer.appendToOutputBuffer(g+"objRefFn = () -> s = CoffeeScript.compile('"+e.replace(/'/g,"\\'")+"', bare: true); eval 'objRef = ' + s\n"),this.outputBuffer.appendToOutputBuffer(g+"html.push(haml.HamlRuntime.generateElementAttributes(this, '"+a+"', ['"+b.join("','")+"'], objRefFn ? null, "+JSON.stringify(c)+", hashFunction ? null, "+f.lineNumber+", "+f.characterNumber+", '"+this.escapeCode(f.currentLine)+"'))\n")},b.prototype.replaceReservedWordsInHash=function(a){var b,c,d,e,f;for(c=a,f=["class","for"],d=0,e=f.length;e>d;d++)b=f[d],c=c.replace(b+":","'"+b+"':");return c},b.prototype.escapeCode=function(a){var b,c,d,e,f;for(c="",b=0,f=this.embeddedCodeBlockMatcher.exec(a);f;)f.index>0&&(d=a.charAt(f.index-1)),f.index>1&&(e=a.charAt(f.index-2)),"\\"===d&&"\\"!==e?(0!==f.index&&(c+=this._escapeText(a.substring(b,f.index-1))),c+=this._escapeText("\\"+f[0])):(c+=this._escapeText(a.substring(b,f.index)),c+=f[0]),b=this.embeddedCodeBlockMatcher.lastIndex,f=this.embeddedCodeBlockMatcher.exec(a);return b<a.length&&(c+=this._escapeText(a.substring(b))),c},b.prototype._escapeText=function(a){return a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/(^|[^\\]{2})\\\\#{/g,"$1\\#{")},b.prototype.generateJsFunction=function(a){var b,c;try{return c=CoffeeScript.compile(a,{bare:!0}),new Function(c)}catch(d){throw b=d,"Incorrect embedded code has resulted in an invalid Haml function - "+b+"\nGenerated Function:\n"+c}},b.prototype.generateFlush=function(a){return this.calcCodeIndent()+"html.push('"+this.escapeCode(a)+"')\n"},b.prototype.setIndent=function(a){return this.indent=a},b.prototype.mark=function(){return this.prevIndent=this.indent},b.prototype.calcCodeIndent=function(){var a,b,c,e,f,g;for(a=0,b=c=0,e=this.indent;e>=0?e>=c:c>=e;b=e>=0?++c:--c)((null!=(f=this.elementStack[b])?f.block:void 0)||(null!=(g=this.elementStack[b])?g.fnBlock:void 0))&&(a+=1);return d.indentText(a)},b.prototype.appendTextContents=function(a,b,c,d){var e,f;return b&&a.match(/#{[^}]*}/)?(this.outputBuffer.flush(),e=f="",(null!=d?d.escapeHTML:void 0)?(e="haml.HamlRuntime.escapeHTML(",f=")"):(null!=d?d.perserveWhitespace:void 0)&&(e="haml.HamlRuntime.perserveWhitespace(",f=")"),this.outputBuffer.appendToOutputBuffer(this.calcCodeIndent()+"html.push("+e+'"'+this.escapeCode(a)+'"'+f+")\n")):((null!=d?d.escapeHTML:void 0)&&(a=haml.HamlRuntime.escapeHTML(a)),(null!=d?d.perserveWhitespace:void 0)&&(a=haml.HamlRuntime.perserveWhitespace(a)),this.outputBuffer.append(a))},b}(b),h={plain:function(a,b,c,d){var e,f,g;for(f=0,g=a.length;g>f;f++)e=a[f],b.appendTextContents(c+e+"\n",!0,d);return!0},javascript:function(a,b,c,d){var e,f,g;for(b.outputBuffer.append(c+'<script type="text/javascript">\n'),b.outputBuffer.append(c+"//<![CDATA[\n"),f=0,g=a.length;g>f;f++)e=a[f],b.appendTextContents(c+e+"\n",!0,d);return b.outputBuffer.append(c+"//]]>\n"),b.outputBuffer.append(c+"</script>\n")},css:function(a,b,c,d){var e,f,g;for(b.outputBuffer.append(c+'<style type="text/css">\n'),b.outputBuffer.append(c+"/*<![CDATA[*/\n"),f=0,g=a.length;g>f;f++)e=a[f],b.appendTextContents(c+e+"\n",!0,d);return b.outputBuffer.append(c+"/*]]>*/\n"),b.outputBuffer.append(c+"</style>\n")},cdata:function(a,b,c,d){var e,f,g;for(b.outputBuffer.append(c+"<![CDATA[\n"),f=0,g=a.length;g>f;f++)e=a[f],b.appendTextContents(c+e+"\n",!0,d);return b.outputBuffer.append(c+"]]>\n")},preserve:function(a,b,c,d){return b.appendTextContents(a.join("\n")+"\n",!0,d,{perserveWhitespace:!0})},escape:function(a,b,c,d){var e,f,g;for(f=0,g=a.length;g>f;f++)e=a[f],b.appendTextContents(c+e+"\n",!0,d,{escapeHTML:!0});return!0}},i.haml={compileHaml:function(a){var b,c,d;if("string"==typeof a)return this._compileHamlTemplate(a,new haml.JsCodeGenerator);if(b=function(){switch(a.generator){case"coffeescript":return new haml.CoffeeCodeGenerator;case"productionjavascript":return new haml.ProductionJsCodeGenerator;default:return new haml.JsCodeGenerator}}(),null!=a.source)d=new haml.Tokeniser({template:a.source});else if(null!=a.sourceId)d=new haml.Tokeniser({templateId:a.sourceId});else{if(null==a.sourceUrl)throw"No template source specified for compileHaml. You need to provide a source, sourceId or sourceUrl option";d=new haml.Tokeniser({templateUrl:a.sourceUrl})}return c=this._compileHamlToJs(d,b),"string"!==a.outputFormat?b.generateJsFunction(c):"function (context) {\n"+c+"}\n"},compileCoffeeHaml:function(a){return this._compileHamlTemplate(a,new haml.CoffeeCodeGenerator)},compileStringToJs:function(a){var b,c;return b=new haml.JsCodeGenerator,c=this._compileHamlToJs(new haml.Tokeniser({template:a}),b),b.generateJsFunction(c)},compileCoffeeHamlFromString:function(a){var b,c;return b=new haml.CoffeeCodeGenerator,c=this._compileHamlToJs(new haml.Tokeniser({template:a}),b),b.generateJsFunction(c)},compileHamlToJsString:function(a){var b;return b="function (context) {\n",b+=this._compileHamlToJs(new haml.Tokeniser({template:a}),new haml.JsCodeGenerator),b+="}\n"},_compileHamlTemplate:function(a,b){var c,d;return haml.cache||(haml.cache={}),haml.cache[a]?haml.cache[a]:(d=this._compileHamlToJs(new haml.Tokeniser({templateId:a}),b),c=b.generateJsFunction(d),haml.cache[a]=c,c)},_compileHamlToJs:function(a,b){var c;for(b.elementStack=[],b.initOutput(),a.getNextToken();!a.token.eof;)a.token.eol?(b.outputBuffer.append(a.token.matched),a.getNextToken()):(c=this._whitespace(a),b.setIndent(c),a.token.eol?(b.outputBuffer.append(d.indentText(c)+a.token.matched),a.getNextToken()):a.token.doctype?this._doctype(a,c,b):a.token.exclamation?this._ignoredLine(a,c,b.elementStack,b):a.token.equal||a.token.escapeHtml||a.token.unescapeHtml||a.token.tilde?this._embeddedJs(a,c,b.elementStack,{innerWhitespace:!0},b):a.token.minus?this._jsLine(a,c,b.elementStack,b):a.token.comment||a.token.slash?this._commentLine(a,c,b.elementStack,b):a.token.amp?this._escapedLine(a,c,b.elementStack,b):a.token.filter?this._filter(a,c,b):this._templateLine(a,b.elementStack,c,b));return this._closeElements(0,b.elementStack,a,b),b.closeAndReturnOutput()},_doctype:function(a,b,c){var e,f;if(a.token.doctype){if(c.outputBuffer.append(d.indentText(b)),a.getNextToken(),a.token.ws&&a.getNextToken(),e=a.skipToEOLorEOF(),e&&e.length>0)switch(f=e.split(/\s+/),f[0]){case"XML":f.length>1?c.outputBuffer.append("<?xml version='1.0' encoding='"+f[1]+"' ?>"):c.outputBuffer.append("<?xml version='1.0' encoding='utf-8' ?>");break;case"Strict":c.outputBuffer.append('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">');break;case"Frameset":c.outputBuffer.append('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">');break;case"5":c.outputBuffer.append("<!DOCTYPE html>");break;case"1.1":c.outputBuffer.append('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">');break;case"Basic":c.outputBuffer.append('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd">');break;case"Mobile":c.outputBuffer.append('<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.2//EN" "http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd">');break;case"RDFa":c.outputBuffer.append('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN" "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">')}else c.outputBuffer.append('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">');return c.outputBuffer.append(this._newline(a)),a.getNextToken()}},_filter:function(a,b,c){var d,e,f,g;if(a.token.filter){if(d=a.token.tokenString,!haml.filters[d])throw a.parseError("Filter '"+d+"' not registered. Filter functions need to be added to 'haml.filters'.");for(a.skipToEOLorEOF(),a.getNextToken(),f=haml._whitespace(a),e=[];!a.token.eof&&f>b;)g=a.skipToEOLorEOF(),e.push(haml.HamlRuntime.indentText(f-b-1)+g),a.getNextToken(),f=haml._whitespace(a);return haml.filters[d](e,c,haml.HamlRuntime.indentText(b),a.currentParsePoint()),a.pushBackToken()}},_commentLine:function(a,b,c,e){var f,g;if(a.token.comment){for(a.skipToEOLorEOF(),a.getNextToken(),g=this._whitespace(a);!a.token.eof&&g>b;)a.skipToEOLorEOF(),a.getNextToken(),g=this._whitespace(a);if(g>0)return a.pushBackToken()}else if(a.token.slash)return haml._closeElements(b,c,a,e),e.outputBuffer.append(d.indentText(b)),e.outputBuffer.append("<!--"),a.getNextToken(),f=a.skipToEOLorEOF(),f&&f.length>0&&e.outputBuffer.append(f),f&&(_.str||_).startsWith(f,"[")&&f.match(/\]\s*$/)?(c[b]={htmlConditionalComment:!0,eol:this._newline(a)},e.outputBuffer.append(">")):c[b]={htmlComment:!0,eol:this._newline(a)},haml._tagHasContents(b,a)&&e.outputBuffer.append("\n"),a.getNextToken()},_escapedLine:function(a,b,c,e){var f;return a.token.amp?(haml._closeElements(b,c,a,e),e.outputBuffer.append(d.indentText(b)),a.getNextToken(),f=a.skipToEOLorEOF(),f&&f.length>0&&e.outputBuffer.append(haml.HamlRuntime.escapeHTML(f)),e.outputBuffer.append(this._newline(a)),a.getNextToken()):void 0
},_ignoredLine:function(a,b,c,e){var f;return a.token.exclamation?(a.getNextToken(),a.token.ws&&(b+=haml._whitespace(a)),haml._closeElements(b,c,a,e),f=a.skipToEOLorEOF(),e.outputBuffer.append(d.indentText(b)+f)):void 0},_embeddedJs:function(a,b,c,e,f){var g,h,i,j,k;return c&&haml._closeElements(b,c,a,f),(a.token.equal||a.token.escapeHtml||a.token.unescapeHtml||a.token.tilde)&&(h=a.token.escapeHtml||a.token.equal,k=a.token.tilde,g=a.currentParsePoint(),a.getNextToken(),i=a.skipToEOLorEOF(),j=d.indentText(b),(!e||e.innerWhitespace)&&f.outputBuffer.append(j),f.appendEmbeddedCode(j,i,h,k,g),(!e||e.innerWhitespace)&&(f.outputBuffer.append(this._newline(a)),a.token.eol))?a.getNextToken():void 0},_jsLine:function(a,b,c,d){var e;if(a.token.minus){if(haml._closeElements(b,c,a,d),a.getNextToken(),e=a.skipToEOLorEOF(),d.setIndent(b),d.appendCodeLine(e,this._newline(a)),a.token.eol&&a.getNextToken(),d.lineMatchesStartFunctionBlock(e))return c[b]={fnBlock:!0};if(d.lineMatchesStartBlock(e))return c[b]={block:!0}}},_templateLine:function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r;if(a.token.eol||this._closeElements(c,b,a,e),m=this._element(a),l=this._idSelector(a),h=this._classSelector(a),p=this._objectReference(a),f=this._attributeList(a),j=a.currentParsePoint(),g=this._attributeHash(a),r={selfClosingTag:!1,innerWhitespace:!0,outerWhitespace:!0},o=this._lineHasElement(m,l,h),a.token.slash&&(r.selfClosingTag=!0,a.getNextToken()),a.token.gt&&o&&(r.outerWhitespace=!1,a.getNextToken()),a.token.lt&&o&&(r.innerWhitespace=!1,a.getNextToken()),o&&(r.selfClosingTag||(r.selfClosingTag=haml._isSelfClosingTag(m)&&!haml._tagHasContents(c,a)),this._openElement(j,c,m,l,h,p,f,g,b,r,e)),k=!1,a.token.ws&&a.getNextToken(),a.token.equal||a.token.escapeHtml||a.token.unescapeHtml?(this._embeddedJs(a,c+1,null,r,e),k=!0):(i="",q=!1,a.token.exclamation?(a.getNextToken(),i=a.skipToEOLorEOF()):(i=a.skipToEOLorEOF(),i.match(/^\\/)&&(i=i.substring(1)),q=!0),k=i.length>0,k&&(r.innerWhitespace&&o||!o&&haml._parentInnerWhitespace(b,c)?n=d.indentText(m.length>0?c+1:c):(n="",i=(_.str||_).trim(i)),e.appendTextContents(n+i,q,j),e.outputBuffer.append(this._newline(a))),this._eolOrEof(a)),r.selfClosingTag&&k)throw haml.HamlRuntime.templateError(j.lineNumber,j.characterNumber,j.currentLine,"A self-closing tag can not have any contents")},_attributeHash:function(a){var b;return b="",a.token.attributeHash&&(b=a.token.tokenString,a.getNextToken()),b},_objectReference:function(a){var b;return b="",a.token.objectReference&&(b=a.token.tokenString,a.getNextToken()),b},_attributeList:function(a){var b,c;if(c={},a.token.openBracket){for(a.getNextToken();!a.token.closeBracket;)if(b=haml._attribute(a),b?c[b.name]=b.value:a.getNextToken(),a.token.ws||a.token.eol)a.getNextToken();else if(!a.token.closeBracket&&!a.token.identifier)throw a.parseError("Expecting either an attribute name to continue the attibutes or a closing bracket to end");a.getNextToken()}return c},_attribute:function(a){var b,c;if(b=null,a.token.identifier){if(c=a.token.tokenString,a.getNextToken(),haml._whitespace(a),!a.token.equal)throw a.parseError("Expected '=' after attribute name");if(a.getNextToken(),haml._whitespace(a),!a.token.string&&!a.token.identifier)throw a.parseError("Expected a quoted string or an identifier for the attribute value");b={name:c,value:a.token.tokenString},a.getNextToken()}return b},_closeElement:function(a,b,c,e){var f,g;return b[a]?(e.setIndent(a),b[a].htmlComment?e.outputBuffer.append(d.indentText(a)+"-->"+b[a].eol):b[a].htmlConditionalComment?e.outputBuffer.append(d.indentText(a)+"<![endif]-->"+b[a].eol):b[a].block?e.closeOffCodeBlock(c):b[a].fnBlock?e.closeOffFunctionBlock(c):(f=!b[a].tagOptions||b[a].tagOptions.innerWhitespace,f?e.outputBuffer.append(d.indentText(a)):e.outputBuffer.trimWhitespace(),e.outputBuffer.append("</"+b[a].tag+">"),g=!b[a].tagOptions||b[a].tagOptions.outerWhitespace,haml._parentInnerWhitespace(b,a)&&g&&e.outputBuffer.append("\n")),b[a]=null,e.mark()):void 0},_closeElements:function(a,b,c,d){var e,f;for(e=b.length-1,f=[];e>=a;)f.push(this._closeElement(e--,b,c,d));return f},_openElement:function(a,b,c,e,f,g,h,i,j,k,l){var m,n,o;if(m=0===c.length?"div":c,n=this._parentInnerWhitespace(j,b),o=!k||k.outerWhitespace,o||l.outputBuffer.trimWhitespace(),b>0&&n&&o&&l.outputBuffer.append(d.indentText(b)),l.outputBuffer.append("<"+m),i.length>0||g.length>0?l.generateCodeForDynamicAttributes(e,f,h,i,g,a):l.outputBuffer.append(d.generateElementAttributes(null,e,f,null,h,null,a.lineNumber,a.characterNumber,a.currentLine)),k.selfClosingTag){if(l.outputBuffer.append("/>"),k.outerWhitespace)return l.outputBuffer.append("\n")}else if(l.outputBuffer.append(">"),j[b]={tag:m,tagOptions:k},k.innerWhitespace)return l.outputBuffer.append("\n")},_isSelfClosingTag:function(a){return"meta"===a||"img"===a||"link"===a||"script"===a||"br"===a||"hr"===a},_tagHasContents:function(a,b){var c;return b.isEolOrEof()?(c=b.lookAhead(1),c.ws&&c.tokenString.length/2>a):!0},_parentInnerWhitespace:function(a,b){return 0===b||!a[b-1]||!a[b-1].tagOptions||a[b-1].tagOptions.innerWhitespace},_lineHasElement:function(a,b,c){return a.length>0||b.length>0||c.length>0},hasValue:function(a){return null!=a&&a!==!1},attrValue:function(a,b){return"selected"===a||"checked"===a||"disabled"===a?a:b},_whitespace:function(a){var b,c,d;if(c=0,a.token.ws){for(b=0,d=a.token.tokenString;b<d.length;)9===d.charCodeAt(b)&&0===b%2?c+=2:c++,b++;c=Math.floor((c+1)/2),a.getNextToken()}return c},_element:function(a){var b;return b="",a.token.element&&(b=a.token.tokenString,a.getNextToken()),b},_eolOrEof:function(a){if(a.token.eol||a.token.continueLine)return a.getNextToken();if(!a.token.eof)throw a.parseError("Expected EOL or EOF")},_idSelector:function(a){var b;return b="",a.token.idSelector&&(b=a.token.tokenString,a.getNextToken()),b},_classSelector:function(a){var b;for(b=[];a.token.classSelector;)b.push(a.token.tokenString),a.getNextToken();return b},_newline:function(a){return a.token.eol?a.token.matched:a.token.continueLine?a.token.matched.substring(1):"\n"}},i.haml.Tokeniser=g,i.haml.Buffer=a,i.haml.JsCodeGenerator=e,i.haml.ProductionJsCodeGenerator=f,i.haml.CoffeeCodeGenerator=c,i.haml.HamlRuntime=d,i.haml.filters=h}.call(this),a.fn.haml=function(b){html=haml.compileHaml({source:b}),html=html(),console.log(html),a(this).html(html)}}(jQuery),function(a){var b,c,d,e,f;return f=function(a,b){var c;return b/=100,c=parseInt(a.length*b),a.substring(0,c)},e=function(b,c){var d,e;return c.normalize_to=c.normalise_to||b.length,c.normalize_to=100,"string"==typeof c.normalize_to&&(c.normalize_to=c.normalize_to.length),e=b.length/c.normalize_to,d={duration:(c.duration||1200)*e,humanize:!1,resolution:b.length,cursor:!1},a.extend(d,c)},d=function(b,c){var d;return d={duration:90*b.length,humanize:!0,resolution:b.length,cursor:!0},a.extend(d,c)},a.fn.handsome=function(a,b,c){var g,h,i,j,k,l,m,n;return null==b&&(b={}),null==c&&(c=function(){}),a=a||this.text()||"",b=b.human?d(a,b):e(a,b),n=b.duration/b.resolution,i=this,j=0,m=0,l="",k="",g=0,(h=function(){return j++,m=100*(j/n),console.log(m),l=f(a,m),l!==k&&(b.cursor&&(l+="|"),i.html(l)),n>j?(g=b.duration/n,b.humanize&&(g+=Math.floor(250*Math.random())-100),setTimeout(h,g)):(b.cursor&&i.text(i.text().replace(/\|$/,"")),"function"==typeof c?c():void 0)})()},a.fn.climb=function(d,e,f){var g,h,i,j,k,l;return null==e&&(e={}),g=e.delay||20,f=f||function(){},i=a(this),k=i.text()||d||0,console.log(e),parseInt(k)&&(l=e.average?b(k,e):c(k,e)),j=0,(h=function(){return i.text(l[j]),j++,j>=l.length?f:setTimeout(h,g)})()},c=function(a,b){var c,d,e,f,g;return console.log("hi"),f=b.time||1200,c=b.delay||10,e=b.steps||f/c,e>a&&(e=a),d=function(){g=[];for(var a=0;e>=0?e>=a:a>=e;e>=0?a++:a--)g.push(a);return g}.apply(this).map(function(b){return parseInt(a*(b/e))})},b=function(a,b){var c,d,e,f,g,h,i,j;return c=b.average||100,j=b.time||1200,d=b.delay||20,h=b.max||5e3,g=j/d,f=c/g,a/f*d>h&&(f=1.5*c/g),i=function(){var b,c;for(c=[],e=b=0;f>0?a>=b:b>=a;e=b+=f)c.push(parseInt(e));return c}()},a.handsome=function(b,c){var d;return null==b&&(b={}),null==c&&(c=function(){}),d=b.sel||".handsome",a(d).each(function(){return a(this).handsome(null,b,c)})},a.climb=function(b,c){var d;return null==b&&(b={}),null==c&&(c=function(){}),d=b.sel||".climb",a(d).each(function(){return a(this).climb(b,c)})}}(jQuery);var root;root="undefined"!=typeof module&&null!==module?module:window,$(function(){return $.stick=function(){var a,b,c,d;return c={},d=function(a){var b;for(null==a&&(a=7),b="";b.length<a;)b+=Math.random().toString(36).substr(2);return"id"+b.substr(0,a)},c.reset=function(){return root.fb.set({}),$(root.sel).each(function(){var a;return a=$(this),b(a,"")})},c.init=function(e,f,g){return null==f&&(f=d()),null==g&&(g=".stick"),root.sel=g,root.fb=new Firebase("http://"+e+".firebaseio.com").child(f),$(root.sel).each(function(d){var e,f,g;return e=$(this),g=e.prop("tagName")||"",f=e.attr("id")||"id"+g+d,e.attr("stick-id",f),root.fb.on("value",function(d){var f;return f=d.val()||{},Object.keys(f).forEach(function(c){var d;return d=$('[stick-id="'+c+'"]'),a(d)!==f[c]?b(d,f[c]):void 0}),e.change(function(){return c.update(e)}),e.attr("contentEditable",!0)?e.on("blur",function(){return e.trigger("change")}):void 0})})},c.update=function(b){var c;return c={},root.fb.once("value",function(d){return c=d.val()||{},console.log(c),c[b.attr("stick-id")]=a(b),root.fb.set(c)})},a=function(a){return a.is("input")&&"checkbox"===a.attr("type")?a.is(":checked"):a.is("input")?a.val():a.is("textarea")?a.val():a.attr("contentEditable",!0)?a.html():a.val()||a.html()},b=function(a,b){return a.is("input")&&"checkbox"===a.attr("type")?a.prop("checked",b):a.is("input")?a.val(b):a.is("textarea")?a.val(b):a.attr("contentEditable",!0)?a.html(b):a.val(b)},c}()}),function(a){return a.fn.type=function(a){var b,c;return c=void 0,b=this,this.keyup(function(){return window.clearTimeout(c),c=window.setTimeout(function(){return a(b.val()),b},700)})}}(jQuery),function(a){return a.fn.waist=function(b,c){var d,e,f,g,h,i,j;return null==b&&(b=null),null==c&&(c={}),e=a("input").css("font-family")||"Lucida Grande",b=b||this.text()||"",this.css("text-align","center"),c.min=c.min||8,g=c.height||.8*this.height()||200,j=c.width||this.width()||200,i=Math.floor(j/b.length),h="slkjeoclcmlsekjc",a("body").append('<span id="'+h+'" style="opacity:0.0; font-size:10px; font-family:'+e+';">'+b+"</span>"),h="#"+h,d=Math.ceil(a(h).width()/b.length),a(h).remove(),f=Math.floor(i/(d/10)),f>g&&(f=g),f<c.min&&(f=c.min),this.text(b),this.css("font-size",parseInt(f))},a.waist=function(b){var c;return null==b&&(b={}),c=b.sel||".waist",a(c).each(function(){return a(this).waist(null,b)})}}(jQuery),$(function(){var a,b,c,d,e,f;return e=function(){var a,b;return b=[{left:0,top:100},{left:0,top:-100},{left:100,top:0},{left:-100,top:0}],a=Math.floor(Math.random()*b.length),b[a]},d=function(){var a,b;return a=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],b=Math.floor(Math.random()*a.length),a[b]},c=0,f=function(){var a,b;return console.log("prepare"),c++,b=e(),a=$('<span class="box next"></span>'),a.html(c),a.css("background",d()),a.css("left",""+b.left+"%"),a.css("top",""+b.top+"%"),$("#stage").append(a)},b=function(){return console.log("cleanup"),$(this).siblings(".current").remove(),$(this).addClass("current"),$(this).removeClass("next"),$(this).siblings(".next").remove(),f()},a=function(){return console.log($(".next").length),$(".next").animate({left:"0%",top:"0%"},400,"easeInExpo",b)},f(),window.setInterval(function(){return a()},2e3)});